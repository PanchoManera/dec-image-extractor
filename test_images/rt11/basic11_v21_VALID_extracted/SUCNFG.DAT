OS(L$,I$,2)
820 IF C5%=0 THEN PRINT 'ERROR #5'
830 T$=SEG$(L$,1,C5%)
840 T%=LEN(T$)
850 L$=SEG$(L$,T%+1,L%)
860 L%=L%-T%
870 GOSUB 1940 \ GO TO 540
880 RETURN
890 REM HANDLER FOR OPEN STATEMENT
900 REM ALSO HANDLE VF
910 K$='' \ K1$=''
920 GOSUBT$
1960 IF T%<>-1 THEN  GO TO 2020
1970 IF P%=1 THEN  GO TO 1990
1980 IF F1$='' THEN  GO TO 2010
1990 IF LEN(O$)=0 THEN  GO TO 2020
2000 PRINT #2,O$
2010 O$=''
2020 RETURN
2030 REM ROUTINE TO GET A NEW LINE
2040 K$=O$+T$+L$
2050 L%=0
2060 PRINT 10 REM 
10 REM 	COPYRIGHT (C) 1977
10 REM 	DIGITAL EQUIPMENT CORPORATION
10 REM 
10 REM THIS SOFTWARE IS FURNISHED UNDER A LICENSE FOR USE ONLY ON A
10 REM SINGLE COMPUTER SYSTEM AND MAY BE COPIED ONLY WITH THE INCLU-
10 REM SION OF THE ABOVE COPYRIG 1940
930 GOSUB 540 \ IF T%=0 THEN  GO TO 1160
940 IF SEG$(T$,1,1)<>'(' THEN  GO TO 980
950 GOSUB 540
960 K$=' ,FILESIZE '+T$ \ GOSUB 540
970 GO TO 930
980 IF SEG$(T$,1,2)<>'VF' THEN  GO TO 920
990 V%=VAL(SEG$(T$,3,3))
1000 IF LEN(V$(V%,1))<>0 THENHT NOTICE. THIS SOFTWARE, OR ANY OTHER
10 REM COPIES THEREOF, MAY NOT BE PROVIDED OR OTHERWISE MADE AVAILABLE
10 REM TO ANY OTHER PERSON EXCEPT FOR USE ON SUCH SYSTEM AND TO ONE WHO
10 REM AGREES TO THESE LICENSE TERMS. TITLE TO AND OWNERSHIP OF THE
10  GO TO 1120
1010 PRINT 'VIRTUAL ARRAY NAME ';T$
1020 PRINT 'NEW NAME '; \ INPUT Q$
1030 IF LEN(Q$)=0 THEN  GO TO 1020
1040 IF Q$='LIST' THEN PRINT O$+T$+L$ \ GO TO 1020
1050 V$(V%,1)=Q$
1060 IF POS(Q$,'$',1)=0 THEN  GO TO 1090
1070 IF POS(L$,'=',1) REM SOFTWARE SHALL AT ALL TIMES  REMAIN IN DEC.
10 REM
10 REM THE INFORMATION IN THIS SOFTWARE IS SUBJECT TO CHANGE WITHOUT
10 REM NOTICE AND SHOULD NOT BE CONSTRUED AS A COMMITMENT BY DIGITAL
10 REM EQUIPMENT CORPORATION.
10 REM 
10 REM DEC ASSUMES<>0 THEN  GO TO 1090
1080 K1$='=32' \ REM OLD DEFALUT STRING LENGTH
1090 PRINT 'CHANNEL NUMBER '; \ INPUT Q$
1100 IF LEN(Q$)=0 THEN  GO TO 1090
1110 V$(V%,2)=Q$
1120 T$='#'+V$(V%,2)+K$+'\DIM #'+V$(V%,2)+', '+V$(V%,1)+L$+K1$
1130 K$='' \ L%=0 \ K1$='' NO RESPONSIBILITY FOR THE USE OR RELIABILITY  OF ITS
10 REM SOFTWARE ON EQUIPMENT WHICH IS NOT SUPPLIED BY DEC.
10 REM
10 REM
20 P%=1 \ REM PASS NUMBER 1
30 J1%=1 \ J2%=3
40 OPEN F0$ FOR INPUT AS FILE #1
50 OPEN "CONVRT.TMP" FOR OUTPUT AS FILE #2

1140 GOSUB 1940 \ GOSUB 540 \ IF T%=0 THEN  GO TO 1160
1150 GO TO 1140
1160 T%=-1 \ T$=T$+K$ \ GOSUB 1940 \ RETURN
1170 REM	HANDLER OF DEF STEMENT
1180 GOSUB 1940 \ REM OUTPUT TOKEN
1190 GOSUB 540 \ REM GET NEXT TOKEN
1200 IF T%=0 THEN  GO TO 135060 IF END #1 THEN  GO TO 270
70 LINPUT #1,L$ \ L%=LEN(L$)
80 GOSUB 540
90 IF VAL(T$)<=32676 THEN  GO TO 140
100 PRINT 'LINE NUMBER GREATER THAN MAX'
110 PRINT 'OLD LINE: ';T$+L$ \ PRINT 'NEW LINE NUMBER:'; \ INPUT Q$
120 IF LEN(Q$)=0 THEN  GO TO 140
1210 PRINT 'FUNCTION NAME: ';T$
1220 PRINT 'NEW NAME: '; \ INPUT Q$
1230 IF LEN(Q$)=0 THEN  GO TO 1330
1240 IF Q$='LIST' THEN PRINT O$+T$+L$ \ GO TO 1220
1250 IF LEN(Q$)>5 THEN  GO TO 1290
1260 IF LEN(Q$)<3 THEN  GO TO 1290
1270 IF SEG$(Q$,1,2)<>'FN
130 T$=Q$
140 GOSUB 1940
150 GOSUB 540 \ IF T%<>0 THEN  GO TO 170
160 T%=-1 \ GOSUB 1940 \ GO TO 60
170 FOR J%=J1% TO J2%
180 REM PRINT 'J% ';J%,'T$(J%)';T$(J%),'M2%(J%)';M2%(J%)
190 IF T1%(J%)=0 THEN  GO TO 240
200 IF T$(J%)<>SEG$(T$,T1%(J%),T2%(J' THEN  GO TO 1290
1280 GO TO 1300
1290 PRINT 'ILLEGAL NAME' \ GO TO 1220
1300 F%=F%+1 \ F$(F%,1)=T$ \ F$(F%,2)=Q$
1310 T$=F$(F%,2)+L$
1320 GO TO 1340
1330 T$=T$+L$
1340 T%=-1 \ L%=0 \ GOSUB 1940
1350 RETURN
1360 REM HANDLER FOR REM STATEMENT
137